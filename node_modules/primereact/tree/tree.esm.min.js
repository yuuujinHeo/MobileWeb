import*as e from"react";import{ariaLabel as n,PrimeReactContext as t}from"primereact/api";import{ComponentBase as o,useHandleStyle as r}from"primereact/componentbase";import{SearchIcon as l}from"primereact/icons/search";import{SpinnerIcon as a}from"primereact/icons/spinner";import{classNames as i,mergeProps as c,DomHandler as d,ObjectUtils as p,IconUtils as s}from"primereact/utils";import{CheckIcon as u}from"primereact/icons/check";import{ChevronDownIcon as f}from"primereact/icons/chevrondown";import{ChevronRightIcon as g}from"primereact/icons/chevronright";import{MinusIcon as y}from"primereact/icons/minus";import{Ripple as m}from"primereact/ripple";function h(){return h=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},h.apply(this,arguments)}function v(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}function b(e){if(Array.isArray(e))return v(e)}function x(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function S(e,n){if(e){if("string"==typeof e)return v(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?v(e,n):void 0}}function C(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function E(e,n){if("object"!==k(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,n||"default");if("object"!==k(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}function D(e){var n=E(e,"string");return"symbol"===k(n)?n:String(n)}function I(e,n,t){return(n=D(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function O(e){if(Array.isArray(e))return e}function w(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,r,l,a,i=[],c=!0,d=!1;try{if(l=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(o=l.call(t)).done)&&(i.push(o.value),i.length!==n);c=!0);}catch(e){d=!0,r=e}finally{try{if(!c&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(d)throw r}}return i}}function N(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function K(e,n){return O(e)||w(e,n)||S(e,n)||N()}var T=o.extend({defaultProps:{__TYPE:"Tree",__parentMetadata:null,id:null,value:null,checkboxIcon:null,disabled:!1,selectionMode:null,selectionKeys:null,onSelectionChange:null,contextMenuSelectionKey:null,onContextMenuSelectionChange:null,expandedKeys:null,style:null,className:null,contentStyle:null,contentClassName:null,metaKeySelection:!0,propagateSelectionUp:!0,propagateSelectionDown:!0,loading:!1,loadingIcon:null,expandIcon:null,collapseIcon:null,dragdropScope:null,header:null,footer:null,showHeader:!0,filter:!1,filterIcon:null,filterValue:null,filterBy:"label",filterMode:"lenient",filterPlaceholder:null,filterLocale:void 0,filterTemplate:null,nodeTemplate:null,togglerTemplate:null,onSelect:null,onUnselect:null,onExpand:null,onCollapse:null,onToggle:null,onDragDrop:null,onContextMenu:null,onFilterValueChange:null,onNodeClick:null,onNodeDoubleClick:null,children:void 0},css:{classes:{container:"p-tree-container",loadingIcon:"p-tree-loading-icon",loadingOverlay:"p-tree-loading-overlay p-component-overlay",searchIcon:"p-tree-filter-icon",filterContainer:"p-tree-filter-container",input:"p-tree-filter p-inputtext p-component",header:"p-tree-header",footer:"p-tree-footer",root:function(e){var n=e.props;return i("p-tree p-component",{"p-tree-selectable":n.selectionMode,"p-tree-loading":n.loading,"p-disabled":n.disabled})},label:"p-treenode-label",checkboxIcon:"p-checkbox-icon p-c",checkboxContainer:"p-checkbox p-component",checkbox:function(e){return i("p-checkbox-box",{"p-highlight":e.checked,"p-indeterminate":e.partialChecked,"p-disabled":e.nodeProps.disabled})},nodeIcon:"p-treenode-icon",togglerIcon:"p-tree-toggler-icon",toggler:"p-tree-toggler p-link",droppoint:"p-treenode-droppoint",content:function(e){var n=e.nodeProps,t=e.checked,o=e.selected;return i("p-treenode-content",{"p-treenode-selectable":n.selectionMode&&!1!==n.node.selectable,"p-highlight":(0,e.isCheckboxSelectionMode)()?t:o,"p-highlight-contextmenu":n.contextMenuSelectionKey&&n.contextMenuSelectionKey===n.node.key,"p-disabled":n.disabled})},subgroup:"p-treenode-children",node:function(e){return i("p-treenode",{"p-treenode-leaf":e.isLeaf})}},styles:"\n@layer primereact {\n    .p-tree-container {\n        margin: 0;\n        padding: 0;\n        list-style-type: none;\n        overflow: auto;\n    }\n    \n    .p-treenode-children {\n        margin: 0;\n        padding: 0;\n        list-style-type: none;\n    }\n    \n    .p-treenode-selectable {\n        cursor: pointer;\n        user-select: none;\n    }\n    \n    .p-tree-toggler {\n        cursor: pointer;\n        user-select: none;\n        display: inline-flex;\n        align-items: center;\n        justify-content: center;\n        flex-shrink: 0;\n        overflow: hidden;\n        position: relative;\n    }\n    \n    .p-treenode-leaf > .p-treenode-content .p-tree-toggler {\n        visibility: hidden;\n    }\n    \n    .p-treenode-content {\n        display: flex;\n        align-items: center;\n    }\n    \n    .p-tree-filter {\n        width: 100%;\n    }\n    \n    .p-tree-filter-container {\n        position: relative;\n        display: block;\n        width: 100%;\n    }\n    \n    .p-tree-filter-icon {\n        position: absolute;\n        top: 50%;\n        margin-top: -.5rem;\n    }\n    \n    .p-tree-loading {\n        position: relative;\n        min-height: 4rem;\n    }\n    \n    .p-tree .p-tree-loading-overlay {\n        position: absolute;\n        z-index: 1;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n}\n"}});function P(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=M(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){i=!0,l=e},f:function(){try{a||null==t.return||t.return()}finally{if(i)throw l}}}}function M(e,n){if(e){if("string"==typeof e)return j(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?j(e,n):void 0}}function j(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}function U(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function L(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?U(Object(t),!0).forEach((function(n){I(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):U(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var A=e.memo((function(t){var o,r,l,a,h,v,b,x=e.useRef(null),S=e.useRef(!1),C=t.isNodeLeaf(t.node),k=!!t.expandedKeys&&void 0!==t.expandedKeys[t.node.key]||t.node.expanded,E=t.ptm,D=t.cx,I=function(e){return E(e,{hostName:t.hostName,context:{selected:!Y()&&_(),expanded:k||!1,checked:!!Y()&&H(),isLeaf:C}})},O=function(e){var n=t.expandedKeys?L({},t.expandedKeys):{};n[t.node.key]=!0,t.onToggle({originalEvent:e,value:n}),K(e,!0)},w=function(e){var n=L({},t.expandedKeys);delete n[t.node.key],t.onToggle({originalEvent:e,value:n}),K(e,!1)},N=function(e){t.disabled||(k?w(e):O(e),e.preventDefault(),e.stopPropagation())},K=function(e,n){n?t.onExpand&&t.onExpand({originalEvent:e,node:t.node}):t.onCollapse&&t.onCollapse({originalEvent:e,node:t.node})},T=function(e){if(!t.disabled){var n=e.target.parentElement;if(d.hasClass(n,"p-treenode"))switch(e.which){case 40:var o=n.children[1];if(o)F(o.children[0]);else{for(var r=n.nextElementSibling;r&&d.hasClass(r,"p-treenode-droppoint");)r=r.nextElementSibling;if(r)F(r);else{var l=M(n);l&&F(l)}}e.preventDefault();break;case 38:if(n.previousElementSibling)F(j(n.previousElementSibling));else{var a=U(n);a&&F(a)}e.preventDefault();break;case 39:k||O(e),e.preventDefault();break;case 37:k&&w(e),e.preventDefault();break;case 13:R(e),e.preventDefault()}}},M=function e(n){var t=U(n);return t?t.nextElementSibling||e(t):null},j=function e(n){var t=n.children[1];return t?e(t.children[t.children.length-1]):n},U=function(e){var n=e.parentElement.parentElement;return d.hasClass(n,"p-treenode")?n:null},F=function(e){e&&e.children[0]&&e.children[0].focus()},R=function(e){t.onClick&&t.onClick({originalEvent:e,node:t.node});var n=e.target.nodeName;if(!t.disabled&&"INPUT"!==n&&"BUTTON"!==n&&"A"!==n&&!d.hasClass(e.target,"p-clickable")){if(t.selectionMode&&!1!==t.node.selectable){var o;if(Y()){var r=H();o=t.selectionKeys?L({},t.selectionKeys):{},r?(t.propagateSelectionDown?B(t.node,!1,o):delete o[t.node.key],t.propagateSelectionUp&&t.onPropagateUp&&t.onPropagateUp({originalEvent:e,check:!1,selectionKeys:o}),t.onUnselect&&t.onUnselect({originalEvent:e,node:t.node})):(t.propagateSelectionDown?B(t.node,!0,o):o[t.node.key]={checked:!0},t.propagateSelectionUp&&t.onPropagateUp&&t.onPropagateUp({originalEvent:e,check:!0,selectionKeys:o}),t.onSelect&&t.onSelect({originalEvent:e,node:t.node}))}else{var l=_();if(!S.current&&t.metaKeySelection){var a=e.metaKey||e.ctrlKey;l&&a?($()?o=null:delete(o=L({},t.selectionKeys))[t.node.key],t.onUnselect&&t.onUnselect({originalEvent:e,node:t.node})):($()?o=t.node.key:z()&&((o=a&&t.selectionKeys?L({},t.selectionKeys):{})[t.node.key]=!0),t.onSelect&&t.onSelect({originalEvent:e,node:t.node}))}else $()?l?(o=null,t.onUnselect&&t.onUnselect({originalEvent:e,node:t.node})):(o=t.node.key,t.onSelect&&t.onSelect({originalEvent:e,node:t.node})):l?(delete(o=L({},t.selectionKeys))[t.node.key],t.onUnselect&&t.onUnselect({originalEvent:e,node:t.node})):((o=t.selectionKeys?L({},t.selectionKeys):{})[t.node.key]=!0,t.onSelect&&t.onSelect({originalEvent:e,node:t.node}))}t.onSelectionChange&&t.onSelectionChange({originalEvent:e,value:o})}S.current=!1}},J=function(e){t.onDoubleClick&&t.onDoubleClick({originalEvent:e,node:t.node})},X=function(e){t.disabled||(d.clearSelection(),t.onContextMenuSelectionChange&&t.onContextMenuSelectionChange({originalEvent:e,value:t.node.key}),t.onContextMenu&&t.onContextMenu({originalEvent:e,node:t.node}))},V=function(e){var n,o=e.check,r=e.selectionKeys,l=P(t.node.children);try{for(l.s();!(n=l.n()).done;){var a=n.value;r[a.key]&&r[a.key].checked&&0}}catch(e){l.e(e)}finally{l.f()}var i=t.node.key,c=p.findChildrenByKey(t.originalOptions,i),d=c.some((function(e){return e.key in r})),s=c.every((function(e){return e.key in r&&r[e.key].checked}));d&&!s?r[i]={checked:!1,partialChecked:!0}:s?r[i]={checked:!0,partialChecked:!1}:o?r[i]={checked:!1,partialChecked:!1}:delete r[i],t.propagateSelectionUp&&t.onPropagateUp&&t.onPropagateUp(e)},B=function e(n,t,o){if(t?o[n.key]={checked:!0,partialChecked:!1}:delete o[n.key],n.children&&n.children.length)for(var r=0;r<n.children.length;r++)e(n.children[r],t,o)},_=function(){return!(!t.selectionMode||!t.selectionKeys)&&($()?t.selectionKeys===t.node.key:void 0!==t.selectionKeys[t.node.key])},H=function(){return!!t.selectionKeys&&(t.selectionKeys[t.node.key]&&t.selectionKeys[t.node.key].checked)||!1},$=function(){return t.selectionMode&&"single"===t.selectionMode},z=function(){return t.selectionMode&&"multiple"===t.selectionMode},Y=function(){return t.selectionMode&&"checkbox"===t.selectionMode},q=function(){S.current=!0},G=function(e,n){(e.preventDefault(),!1!==t.node.droppable)&&(d.removeClass(e.target,"p-treenode-droppoint-active"),t.onDropPoint&&t.onDropPoint({originalEvent:e,path:t.path,index:-1===n?t.index:t.index+1,position:n}))},Q=function(e){e.dataTransfer.types[1]===t.dragdropScope.toLocaleLowerCase()&&(e.dataTransfer.dropEffect="move",e.preventDefault())},W=function(e){e.dataTransfer.types[1]===t.dragdropScope.toLocaleLowerCase()&&d.addClass(e.target,"p-treenode-droppoint-active")},Z=function(e){e.dataTransfer.types[1]===t.dragdropScope.toLocaleLowerCase()&&d.removeClass(e.target,"p-treenode-droppoint-active")},ee=function(e){t.dragdropScope&&!1!==t.node.droppable&&(d.removeClass(x.current,"p-treenode-dragover"),e.preventDefault(),e.stopPropagation(),t.onDrop&&t.onDrop({originalEvent:e,path:t.path,index:t.index}))},ne=function(e){e.dataTransfer.types[1]===t.dragdropScope.toLocaleLowerCase()&&!1!==t.node.droppable&&(e.dataTransfer.dropEffect="move",e.preventDefault(),e.stopPropagation())},te=function(e){e.dataTransfer.types[1]===t.dragdropScope.toLocaleLowerCase()&&!1!==t.node.droppable&&d.addClass(x.current,"p-treenode-dragover")},oe=function(e){if(e.dataTransfer.types[1]===t.dragdropScope.toLocaleLowerCase()&&!1!==t.node.droppable){var n=e.currentTarget.getBoundingClientRect();(e.nativeEvent.x>n.left+n.width||e.nativeEvent.x<n.left||e.nativeEvent.y>=Math.floor(n.top+n.height)||e.nativeEvent.y<n.top)&&d.removeClass(x.current,"p-treenode-dragover")}},re=function(e){e.dataTransfer.setData("text",t.dragdropScope),e.dataTransfer.setData(t.dragdropScope,t.dragdropScope),t.onDragStart&&t.onDragStart({originalEvent:e,path:t.path,index:t.index})},le=function(e){t.onDragEnd&&t.onDragEnd({originalEvent:e})},ae=function(){var n=c({className:D("label")},I("label")),o=e.createElement("span",n,t.node.label);t.nodeTemplate&&(o=p.getJSXElement(t.nodeTemplate,t.node,{onTogglerClick:N,className:"p-treenode-label",element:o,props:t,expanded:k}));return o},ie=function(){if(Y()&&!1!==t.node.selectable){var n=H(),o=!!t.selectionKeys&&t.selectionKeys[t.node.key]&&t.selectionKeys[t.node.key].partialChecked,r=c({className:D("checkboxIcon")},I("checkboxIcon")),l=s.getJSXIcon(n?t.checkboxIcon||e.createElement(u,r):o?t.checkboxIcon||e.createElement(y,r):null,L({},r),t),a=c({className:D("checkboxContainer")},I("checkboxContainer")),i=c({className:D("checkbox",{checked:n,partialChecked:o,nodeProps:t}),role:"checkbox","aria-checked":n},I("checkbox"));return e.createElement("div",a,e.createElement("div",i,l))}return null},ce=function(){var n=t.node.icon||(k?t.node.expandedIcon:t.node.collapsedIcon);if(n){var o=c({className:i(n,D("nodeIcon"))},I("nodeIcon"));return e.createElement("span",o)}return null},de=function(){var o=n(k?"collapseLabel":"expandLabel"),r=c({className:D("togglerIcon"),"aria-hidden":!0},I("togglerIcon")),l=s.getJSXIcon(k?t.collapseIcon||e.createElement(f,r):t.expandIcon||e.createElement(g,r),L({},r),{props:t,expanded:k}),a=c({type:"button",className:D("toggler"),tabIndex:-1,onClick:N,"aria-label":o},I("toggler")),i=e.createElement("button",a,l,e.createElement(m,null));t.togglerTemplate&&(i=p.getJSXElement(t.togglerTemplate,t.node,{onClick:N,containerClassName:"p-tree-toggler p-link",iconClassName:"p-tree-toggler-icon",element:i,props:t,expanded:k}));return i},pe=function(n){if(t.dragdropScope){var o=c({className:D("droppoint"),onDrop:function(e){return G(e,n)},onDragOver:Q,onDragEnter:W,onDragLeave:Z},I("droppoint"));return e.createElement("li",o)}return null},se=function(){var n=_(),o=H(),r=de(),l=ie(),a=ce(),d=ae(),p=c({ref:x,className:i(t.node.className,D("content",{checked:o,selected:n,nodeProps:t,isCheckboxSelectionMode:Y})),style:t.node.style,onClick:R,onDoubleClick:J,onContextMenu:X,onTouchEnd:q,draggable:t.dragdropScope&&!1!==t.node.draggable&&!t.disabled,onDrop:ee,onDragOver:ne,onDragEnter:te,onDragLeave:oe,onDragStart:re,onDragEnd:le,onKeyDown:T},I("content"));return e.createElement("div",p,r,l,a,d)},ue=(r=t.disabled?void 0:0,l=_(),a=H(),h=se(),o=c({className:D("subgroup"),role:"group"},I("subgroup")),v=p.isNotEmpty(t.node.children)&&k?e.createElement("ul",o,t.node.children.map((function(n,o){return e.createElement(A,{key:n.key||n.label,node:n,checkboxIcon:t.checkboxIcon,collapseIcon:t.collapseIcon,contextMenuSelectionKey:t.contextMenuSelectionKey,cx:D,disabled:t.disabled,dragdropScope:t.dragdropScope,expandIcon:t.expandIcon,expandedKeys:t.expandedKeys,index:o,isNodeLeaf:t.isNodeLeaf,last:o===t.node.children.length-1,metaKeySelection:t.metaKeySelection,nodeTemplate:t.nodeTemplate,onClick:t.onClick,onCollapse:t.onCollapse,onContextMenu:t.onContextMenu,onContextMenuSelectionChange:t.onContextMenuSelectionChange,onDoubleClick:t.onDoubleClick,onDragEnd:t.onDragEnd,onDragStart:t.onDragStart,onDrop:t.onDrop,onDropPoint:t.onDropPoint,onExpand:t.onExpand,onPropagateUp:V,onSelect:t.onSelect,onSelectionChange:t.onSelectionChange,onToggle:t.onToggle,onUnselect:t.onUnselect,originalOptions:t.originalOptions,parent:t.node,path:t.path+"-"+o,propagateSelectionDown:t.propagateSelectionDown,propagateSelectionUp:t.propagateSelectionUp,ptm:E,selectionKeys:t.selectionKeys,selectionMode:t.selectionMode,togglerTemplate:t.togglerTemplate})}))):null,b=c({className:i(t.node.className,D("node",{isLeaf:C})),style:t.node.style,tabIndex:r,role:"treeitem","aria-posinset":t.index+1,"aria-expanded":k,"aria-selected":a||l},I("node")),e.createElement("li",b,h,v));if(t.dragdropScope&&!t.disabled){var fe=pe(-1),ge=t.last?pe(1):null;return e.createElement(e.Fragment,null,fe,ue,ge)}return ue}));function F(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function R(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?F(Object(t),!0).forEach((function(n){I(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):F(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function J(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=X(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){i=!0,l=e},f:function(){try{a||null==t.return||t.return()}finally{if(i)throw l}}}}function X(e,n){if(e){if("string"==typeof e)return V(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?V(e,n):void 0}}function V(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}A.displayName="UITreeNode";var B=e.memo(e.forwardRef((function(n,o){var u=e.useContext(t),f=T.getProps(n,u),g=K(e.useState(""),2),y=g[0],m=g[1],v=K(e.useState(f.expandedKeys),2),k=v[0],E=v[1],D=e.useRef(null),I=e.useRef([]),O=e.useRef(null),w=e.useRef(!1),N=f.onFilterValueChange?f.filterValue:y,P=f.onToggle?f.expandedKeys:k,M=T.setMetaData({props:f,state:{filterValue:N,expandedKeys:P}}),j=M.ptm,U=M.cx;r(T.css.styles,M.isUnstyled,{name:"tree"});var L={filter:function(e){return Z(e)},reset:function(){return re()}},F=function(e){f.onToggle?f.onToggle(e):E(e.value)},X=function(e){O.current={path:e.path,index:e.index}},V=function(){O.current=null},B=function e(n){if(Array.isArray(n))return n.map(e);if(n&&Object.getPrototypeOf(n)===Object.prototype){var t={};for(var o in n)t[o]="data"!==o?e(n[o]):n[o];return t}return n},_=function(e){if(z(O.current.path,e.path)){var n=B(f.value),t=O.current.path.split("-");t.pop();var o=G(n,t),r=o?o.children[O.current.index]:n[O.current.index],l=G(n,e.path.split("-"));l.children?l.children.push(r):l.children=[r],o?o.children.splice(O.current.index,1):n.splice(O.current.index,1),f.onDragDrop&&f.onDragDrop({originalEvent:e.originalEvent,value:n,dragNode:r,dropNode:l,dropIndex:e.index})}},H=function(e){if(Y(e)){var n=B(f.value),t=O.current.path.split("-");t.pop();var o=e.path.split("-");o.pop();var r=G(n,t),l=G(n,o),a=r?r.children[O.current.index]:n[O.current.index],i=q(O.current.path,e.path);if(r?r.children.splice(O.current.index,1):n.splice(O.current.index,1),e.position<0){var c=i?O.current.index>e.index?e.index:e.index-1:e.index;l?l.children.splice(c,0,a):n.splice(c,0,a)}else l?l.children.push(a):n.push(a);f.onDragDrop&&f.onDragDrop({originalEvent:e.originalEvent,value:n,dragNode:a,dropNode:l,dropIndex:e.index})}},$=function(e,n){return!!e&&(e!==n&&0!==n.indexOf(e))},z=function(e,n){return!!$(e,n)&&!(e.indexOf("-")>0&&e.substring(0,e.lastIndexOf("-"))===n)},Y=function(e){return!!$(O.current.path,e.path)&&(-1!==e.position||!q(O.current.path,e.path)||O.current.index+1!==e.index)},q=function(e,n){return 1===e.length&&1===n.length||e.substring(0,e.lastIndexOf("-"))===n.substring(0,n.lastIndexOf("-"))},G=function e(n,t){if(0===t.length)return null;var o=parseInt(t[0],10),r=n.children?n.children[o]:n[o];return 1===t.length?r:(t.shift(),e(r,t))},Q=function(e){return!1!==e.leaf&&!(e.children&&e.children.length)},W=function(e){13===e.which&&e.preventDefault()},Z=function(e){w.current=!0;var n=e.target.value;f.onFilterValueChange?f.onFilterValueChange({originalEvent:e,value:n}):m(n)},ee=function(e){m(p.isNotEmpty(e)?e:""),ne()},ne=function(){if(w.current){if(p.isEmpty(N))I.current=f.value;else{I.current=[];var e,n=f.filterBy.split(","),t=N.toLocaleLowerCase(f.filterLocale),o="strict"===f.filterMode,r=J(f.value);try{for(r.s();!(e=r.n()).done;){var l=R({},e.value),a={searchFields:n,filterText:t,isStrictMode:o};(o&&(te(l,a)||oe(l,a))||!o&&(oe(l,a)||te(l,a)))&&I.current.push(l)}}catch(e){r.e(e)}finally{r.f()}}w.current=!1}},te=function(e,n){if(e){var t=!1;if(e.children){var o=b(i=e.children)||x(i)||S(i)||C();e.children=[];var r,l=J(o);try{for(l.s();!(r=l.n()).done;){var a=R({},r.value);oe(a,n)&&(t=!0,e.children.push(a))}}catch(e){l.e(e)}finally{l.f()}}if(t)return e.expanded=!0,!0}var i},oe=function(e,n){var t,o=n.searchFields,r=n.filterText,l=n.isStrictMode,a=!1,i=J(o);try{for(i.s();!(t=i.n()).done;){String(p.resolveFieldData(e,t.value)).toLocaleLowerCase(f.filterLocale).indexOf(r)>-1&&(a=!0)}}catch(e){i.e(e)}finally{i.f()}return(!a||l&&!Q(e))&&(a=te(e,{searchFields:o,filterText:r,isStrictMode:l})||a),a},re=function(){m("")};e.useImperativeHandle(o,(function(){return{props:f,filter:ee,getElement:function(){return D.current}}}));var le=function(n,t,o){return e.createElement(A,{hostName:"Tree",key:n.key||n.label,node:n,checkboxIcon:f.checkboxIcon,collapseIcon:f.collapseIcon,contextMenuSelectionKey:f.contextMenuSelectionKey,cx:U,disabled:f.disabled,dragdropScope:f.dragdropScope,expandIcon:f.expandIcon,expandedKeys:P,index:t,isNodeLeaf:Q,last:o,metaKeySelection:f.metaKeySelection,nodeTemplate:f.nodeTemplate,onClick:f.onNodeClick,onCollapse:f.onCollapse,onContextMenu:f.onContextMenu,onContextMenuSelectionChange:f.onContextMenuSelectionChange,onDoubleClick:f.onNodeDoubleClick,onDragEnd:V,onDragStart:X,onDrop:_,onDropPoint:H,onExpand:f.onExpand,onSelect:f.onSelect,onSelectionChange:f.onSelectionChange,onToggle:F,onUnselect:f.onUnselect,originalOptions:f.value,path:String(t),propagateSelectionDown:f.propagateSelectionDown,propagateSelectionUp:f.propagateSelectionUp,ptm:j,selectionKeys:f.selectionKeys,selectionMode:f.selectionMode,togglerTemplate:f.togglerTemplate})},ae=function(){f.filter&&(w.current=!0,ne());var e=f.filter&&I.current?I.current:f.value;return e.map((function(n,t){return le(n,t,t===e.length-1)}))},ie=function(){if(f.filter){var n=p.isNotEmpty(N)?N:"",t=c({className:U("searchIcon")},j("searchIcon")),o=s.getJSXIcon(f.filterIcon||e.createElement(l,t),R({},t),{props:f}),r=c({className:U("filterContainer")},j("filterContainer")),a=c({type:"text",value:n,autoComplete:"off",className:U("input"),placeholder:f.filterPlaceholder,"aria-label":f.filterPlaceholder,onKeyDown:W,onChange:Z,disabled:f.disabled},j("input")),i=e.createElement("div",r,e.createElement("input",a),o);if(f.filterTemplate)i=p.getJSXElement(f.filterTemplate,{className:"p-tree-filter-container",element:i,filterOptions:L,filterInputKeyDown:W,filterInputChange:Z,filterIconClassName:"p-dropdown-filter-icon",props:f});return e.createElement(e.Fragment,null,i)}return null},ce=T.getOtherProps(f),de=p.reduceKeys(ce,d.ARIA_PROPS),pe=function(){if(f.loading){var n=c({className:U("loadingIcon")},j("loadingIcon")),t=f.loadingIcon||e.createElement(a,h({},n,{spin:!0})),o=s.getJSXIcon(t,R({},n),{props:f}),r=c({className:U("loadingOverlay")},j("loadingOverlay"));return e.createElement("div",r,o)}return null}(),se=function(){if(f.value){var n=ae(),t=c(R({className:i(f.contentClassName,U("container")),role:"tree",style:f.contentStyle},de),j("container"));return e.createElement("ul",t,n)}return null}(),ue=function(){if(f.showHeader){var n=ie(),t=n;if(f.header)t=p.getJSXElement(f.header,{filterContainerClassName:"p-tree-filter-container",filterIconClassName:"p-tree-filter-icon",filterInput:{className:"p-tree-filter p-inputtext p-component",onKeyDown:W,onChange:Z},filterElement:n,element:t,props:f});var o=c({className:U("header")},j("header"));return e.createElement("div",o,t)}return null}(),fe=function(){var n=p.getJSXElement(f.footer,f),t=c({className:U("footer")},j("footer"));return e.createElement("div",t,n)}(),ge=c({ref:D,className:i(f.className,U("root")),style:f.style,id:f.id},T.getOtherProps(f),j("root"));return e.createElement("div",ge,pe,ue,se,fe)})));B.displayName="Tree";export{B as Tree};
