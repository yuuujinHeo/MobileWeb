import*as e from"react";import n,{PrimeReactContext as t}from"primereact/api";import{ComponentBase as r,useHandleStyle as o}from"primereact/componentbase";import{CSSTransition as i}from"primereact/csstransition";import{useEventListener as u,useResizeListener as l,useMountEffect as a,useUpdateEffect as c,useMatchMedia as s,useOverlayListener as p,useUnmountEffect as m}from"primereact/hooks";import{OverlayService as d}from"primereact/overlayservice";import{Portal as f}from"primereact/portal";import{classNames as b,mergeProps as v,DomHandler as y,IconUtils as h,ObjectUtils as g,UniqueComponentId as x,ZIndexUtils as w}from"primereact/utils";import{AngleRightIcon as S}from"primereact/icons/angleright";import{Ripple as E}from"primereact/ripple";function I(){return I=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},I.apply(this,arguments)}function O(e){if(Array.isArray(e))return e}function P(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,i,u,l=[],a=!0,c=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;a=!1}else for(;!(a=(r=i.call(t)).done)&&(l.push(r.value),l.length!==n);a=!0);}catch(e){c=!0,o=e}finally{try{if(!a&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(c)throw o}}return l}}function k(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function N(e,n){if(e){if("string"==typeof e)return k(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?k(e,n):void 0}}function M(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function j(e,n){return O(e)||P(e,n)||N(e,n)||M()}var T=r.extend({defaultProps:{__TYPE:"TieredMenu",id:null,model:null,popup:!1,style:null,className:null,autoZIndex:!0,baseZIndex:0,breakpoint:void 0,scrollHeight:"400px",appendTo:null,transitionOptions:null,onShow:null,onHide:null,submenuIcon:null,children:void 0},css:{classes:{root:function(e){var t=e.props,r=e.context;return b("p-tieredmenu p-component",{"p-tieredmenu-overlay":t.popup,"p-input-filled":r&&"filled"===r.inputStyle||"filled"===n.inputStyle,"p-ripple-disabled":r&&!1===r.ripple||!1===n.ripple},t.className)},separator:"p-menu-separator",icon:function(e){return b("p-menuitem-icon",e._icon)},label:"p-menuitem-text",submenuIcon:"p-submenu-icon",action:function(e){return b("p-menuitem-link",{"p-disabled":e.disabled})},menuitem:function(e){return b("p-menuitem",{"p-menuitem-active":e.active},e._className)},menu:function(e){return b({"p-submenu-list":!e.subProps.root})},submenu:function(e){return b({"p-submenu-list":!e.subProps.root})},transition:"p-connected-overlay"},styles:"\n@layer primereact {\n    .p-tieredmenu-overlay {\n        position: absolute;\n    }\n    \n    .p-tieredmenu ul {\n        margin: 0;\n        padding: 0;\n        list-style: none;\n    }\n    \n    .p-tieredmenu .p-submenu-list {\n        position: absolute;\n        min-width: 100%;\n        z-index: 1;\n        display: none;\n    }\n    \n    .p-tieredmenu .p-menuitem-link {\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        text-decoration: none;\n        overflow: hidden;\n        position: relative;\n    }\n    \n    .p-tieredmenu .p-menuitem-text {\n        line-height: 1;\n    }\n    \n    .p-tieredmenu .p-menuitem {\n        position: relative;\n    }\n    \n    .p-tieredmenu .p-menuitem-link .p-submenu-icon {\n        margin-left: auto;\n    }\n    \n    .p-tieredmenu .p-menuitem-active > .p-submenu-list {\n        display: block;\n        left: 100%;\n        top: 0;\n    }\n    \n    .p-tieredmenu .p-menuitem-active > .p-submenu-list-flipped {\n        left: -100%;\n    }\n}\n",inlineStyles:{submenu:function(e){var n=e.subProps;return{display:!n.root&&n.parentActive?"block":"none"}}}}});function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function D(e,n){if("object"!==C(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!==C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}function A(e){var n=D(e,"string");return"symbol"===C(n)?n:String(n)}function H(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function _(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?H(Object(t),!0).forEach((function(n){var r,o,i;r=e,i=t[n],(o=A(o=n))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):H(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var R=e.memo((function(n){var t=j(e.useState(null),2),r=t[0],o=t[1],i=e.useRef(null),s=n.ptm,p=n.cx,m=n.sx,d=function(e,t){return s(t,{hostName:n.hostName,context:{active:r===e}})},f=j(u({type:"click",listener:function(e){n.isMobileMode||!i.current||i.current.contains(e.target)||o(null)}}),1)[0],x=j(l({listener:function(){!n.isMobileMode&&o(null)}}),1)[0],w=function(){if(i.current){var e=i.current.parentElement,n=y.getOffset(e),t=y.getViewport(),r=i.current.offsetParent?i.current.offsetWidth:y.getHiddenElementOuterWidth(i.current),o=y.getOuterWidth(e.children[0]),u=parseInt(n.top,10)+i.current.offsetHeight-y.getWindowScrollTop();i.current.style.top=u>t.height?t.height-u+"px":"0px",parseInt(n.left,10)+o+r>t.width-y.calculateScrollbarWidth()&&y.addClass(i.current,"p-submenu-list-flipped")}},I=function(e,t){t.disabled||n.isMobileMode?e.preventDefault():n.root?(r||n.popup)&&o(t):o(t)},O=function(e,t){t.disabled?e.preventDefault():(t.url||e.preventDefault(),t.command&&t.command({originalEvent:e,item:t}),(n.root||n.isMobileMode)&&t.items&&o(r&&t===r?null:t),t.items||T(e))},P=function(e,t){var r=e.currentTarget.parentElement;switch(e.which){case 40:var i=N(r);i&&i.children[0].focus(),e.preventDefault();break;case 38:var u=M(r);u&&u.children[0].focus(),e.preventDefault();break;case 39:t.items&&(o(t),setTimeout((function(){r.children[1].children[0].children[0].focus()}),50)),e.preventDefault()}n.onKeyDown&&n.onKeyDown(e,r)},k=function(e,n){37===e.which&&(o(null),n.parentElement.previousElementSibling.focus())},N=function e(n){var t=n.nextElementSibling;return t?y.hasClass(t,"p-disabled")||!y.hasClass(t,"p-menuitem")?e(t):t:null},M=function e(n){var t=n.previousElementSibling;return t?y.hasClass(t,"p-disabled")||!y.hasClass(t,"p-menuitem")?e(t):t:null},T=function(e){n.isMobileMode&&!n.popup||(o(null),n.onLeafClick&&n.onLeafClick(e),n.onHide&&n.onHide(e))};a((function(){f(),x()})),c((function(){n.parentActive||o(null),n.root||!n.parentActive||n.isMobileMode||w()}),[n.parentActive]),c((function(){n.onItemToggle&&n.onItemToggle()}),[r]);var C=function(t){var r=v({key:"separator_"+t,className:p("separator"),role:"separator"},s("separator",{hostName:n.hostName}));return e.createElement("li",r)},D=function(t,o){return t.items?e.createElement(R,{id:n.id+"_"+o,menuProps:n.menuProps,model:t.items,onLeafClick:T,popup:n.popup,onKeyDown:k,parentActive:t===r,isMobileMode:n.isMobileMode,onItemToggle:n.onItemToggle,submenuIcon:n.submenuIcon,ptm:n.ptm,cx:p,sx:m}):null},A=function(t,o){if(!1===t.visible)return null;var i=t.className,u=t.style,l=t.disabled,a=t.icon,c=t.label,s=t.items,m=t.target,f=t.url,y=t.template,x=t.id||n.id+"_"+o,w=r===t,k=b("p-menuitem-link",{"p-disabled":l}),N=b("p-menuitem-icon",a),M=v({className:p("icon",{_icon:a})},d(t,"icon")),j=h.getJSXIcon(a,_({},M),{props:n.menuProps}),T=v({className:p("label")},d(t,"label")),C=c&&e.createElement("span",T,c),A=v({className:p("submenuIcon")},d(t,"submenuIcon")),H=t.items&&h.getJSXIcon(n.submenuIcon||e.createElement(S,A),_({},A),{props:n.menuProps}),R=D(t,o),Z=v({href:f||"#",className:p("action",{disabled:l}),target:m,role:"menuitem","aria-haspopup":null!=s,onClick:function(e){return O(e,t)},onKeyDown:function(e){return P(e,t)},"aria-disabled":l},d(t,"action")),K=e.createElement("a",Z,j,C,H,e.createElement(E,null));y&&(K=g.getJSXElement(y,t,{onClick:function(e){return O(e,t)},onKeyDown:function(e){return P(e,t)},className:k,labelClassName:"p-menuitem-text",iconClassName:N,submenuIconClassName:"p-submenu-icon",element:K,props:n,active:w,disabled:l}));var W=v({key:x,id:x,className:p("menuitem",{_className:i,active:w}),style:u,onMouseEnter:function(e){return I(e,t)},role:"none"},d(t,"menuitem"));return e.createElement("li",W,K,R)},H=n.model?n.model.map((function(e,n){return e.separator?C(n):A(e,n)})):null,Z=n.root?"menu":"submenu",K=v({ref:i,className:p(Z,{subProps:n}),style:m(Z,{subProps:n}),role:n.root?"menubar":"menu","aria-orientation":"horizontal"},s(Z,{hostName:n.hostName}));return e.createElement("ul",K,H)}));R.displayName="TieredMenuSub";var Z=e.memo(e.forwardRef((function(r,u){var l=e.useContext(t),b=T.getProps(r,l),h=j(e.useState(b.id),2),g=h[0],S=h[1],E=j(e.useState(!b.popup),2),O=E[0],P=E[1],k=j(e.useState(null),2),N=k[0],M=k[1],C=T.setMetaData({props:b,state:{id:g,visible:O,attributeSelector:N}}),D=C.ptm,A=C.cx,H=C.sx;o(T.css.styles,C.isUnstyled,{name:"tieredmenu"});var _=e.useRef(null),Z=e.useRef(null),K=e.useRef(null),W=s("screen and (max-width: ".concat(b.breakpoint,")"),!!b.breakpoint),z=j(p({target:Z,overlay:_,listener:function(e,n){n.valid&&Y(e)},when:O}),2),L=z[0],J=z[1],X=function(e){b.popup&&d.emit("overlay-click",{originalEvent:e,target:Z.current})},U=function(e){b.popup&&(O?Y(e):V(e))},V=function(e){Z.current=e.currentTarget,P(!0),b.onShow&&b.onShow(e)},Y=function(e){b.popup&&(Z.current=e.currentTarget,P(!1),b.onHide&&b.onHide(e))},$=function(){b.popup&&W&&y.absolutePosition(_.current,Z.current)},q=function(){if(!K.current){K.current=y.createInlineStyle(l&&l.nonce||n.nonce);var e="".concat(N),t="\n@media screen and (max-width: ".concat(b.breakpoint,") {\n    .p-tieredmenu[").concat(e,"] > ul {\n        max-height: ").concat(b.scrollHeight,";\n        overflow: ").concat(b.scrollHeight?"auto":"",";\n    }\n\n    .p-tieredmenu[").concat(e,"] .p-submenu-list {\n        position: relative;\n    }\n\n    .p-tieredmenu[").concat(e,"] .p-menuitem-active > .p-submenu-list {\n        left: 0;\n        box-shadow: none;\n        border-radius: 0;\n        padding: 0 0 0 calc(var(--inline-spacing) * 2); /* @todo */\n    }\n\n    .p-tieredmenu[").concat(e,"] .p-menuitem-active > .p-menuitem-link > .p-submenu-icon {\n        transform: rotate(-180deg);\n    }\n\n    .p-tieredmenu[").concat(e,'] .p-submenu-icon:before {\n        content: "\\e930";\n    }\n\n    ').concat(b.popup?"":".p-tieredmenu[".concat(e,"] { width: 100%; }"),"\n}\n");K.current.innerHTML=t}},B=function(){K.current=y.removeInlineStyle(K.current)},F=function(){b.autoZIndex&&w.set("menu",_.current,l&&l.autoZIndex||n.autoZIndex,b.baseZIndex||l&&l.zIndex.menu||n.zIndex.menu),y.addStyles(_.current,{position:"absolute",top:"0",left:"0"}),y.absolutePosition(_.current,Z.current),N&&b.breakpoint&&(_.current.setAttribute(N,""),q())},G=function(){L()},Q=function(){Z.current=null,J()},ee=function(){w.clear(_.current),B()};a((function(){var e=x();!g&&S(e),b.breakpoint&&!N&&M(e)})),c((function(){return N&&_.current&&(_.current.setAttribute(N,""),q()),function(){B()}}),[N,b.breakpoint]),m((function(){w.clear(_.current)})),e.useImperativeHandle(u,(function(){return{props:b,toggle:U,show:V,hide:Y,getElement:function(){return _.current}}}));var ne,te,re=(ne=v({ref:_,id:b.id,className:A("root"),style:b.style,onClick:X},T.getOtherProps(b),D("root")),te=v({classNames:A("transition"),in:O,timeout:{enter:120,exit:100},options:b.transitionOptions,unmountOnExit:!0,onEnter:F,onEntered:G,onExit:Q,onExited:ee},D("transition")),e.createElement(i,I({nodeRef:_},te),e.createElement("div",ne,e.createElement(R,{id:g,hostName:"TieredMenu",menuProps:b,model:b.model,root:!0,popup:b.popup,onHide:Y,isMobileMode:W,onItemToggle:$,submenuIcon:b.submenuIcon,ptm:D,cx:A,sx:H}))));return b.popup?e.createElement(f,{element:re,appendTo:b.appendTo}):re})));Z.displayName="TieredMenu";export{Z as TieredMenu};
