import*as e from"react";import t,{PrimeReactContext as n,localeOption as l,FilterService as r}from"primereact/api";import{ComponentBase as o,useHandleStyle as i}from"primereact/componentbase";import{useUpdateEffect as a,useMountEffect as c,useOverlayListener as u,useUnmountEffect as s}from"primereact/hooks";import{ChevronDownIcon as p}from"primereact/icons/chevrondown";import{TimesIcon as m}from"primereact/icons/times";import{TimesCircleIcon as f}from"primereact/icons/timescircle";import{OverlayService as d}from"primereact/overlayservice";import{Tooltip as b}from"primereact/tooltip";import{classNames as v,ObjectUtils as h,DomHandler as y,mergeProps as g,IconUtils as O,UniqueComponentId as x,ZIndexUtils as k}from"primereact/utils";import{CSSTransition as E}from"primereact/csstransition";import{Portal as S}from"primereact/portal";import{VirtualScroller as I}from"primereact/virtualscroller";import{CheckIcon as w}from"primereact/icons/check";import{SearchIcon as C}from"primereact/icons/search";import{InputText as N}from"primereact/inputtext";import{Ripple as P}from"primereact/ripple";function j(){return j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},j.apply(this,arguments)}function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function A(e,t){if("object"!==D(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var l=n.call(e,t||"default");if("object"!==D(l))return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function L(e){var t=A(e,"string");return"symbol"===D(t)?t:String(t)}function F(e,t,n){return(t=L(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,l=new Array(t);n<t;n++)l[n]=e[n];return l}function M(e){if(Array.isArray(e))return T(e)}function R(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function V(e,t){if(e){if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(e,t):void 0}}function G(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function K(e){return M(e)||R(e)||V(e)||G()}function H(e){if(Array.isArray(e))return e}function J(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var l,r,o,i,a=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(l=o.call(n)).done)&&(a.push(l.value),a.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw r}}return a}}function X(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _(e,t){return H(e)||J(e,t)||V(e,t)||X()}var B=o.extend({defaultProps:{__TYPE:"MultiSelect",appendTo:null,ariaLabelledBy:null,checkboxIcon:null,className:null,clearIcon:null,closeIcon:null,dataKey:null,disabled:!1,display:"comma",dropdownIcon:null,emptyMessage:null,emptyFilterMessage:null,filter:!1,filterBy:null,filterInputAutoFocus:!0,filterLocale:void 0,filterMatchMode:"contains",filterPlaceholder:null,filterTemplate:null,fixedPlaceholder:!1,flex:!1,id:null,inline:!1,inputId:null,inputRef:null,itemCheckboxIcon:null,itemClassName:null,itemTemplate:null,maxSelectedLabels:null,name:null,onBlur:null,onChange:null,onClick:null,onFilter:null,onFocus:null,onHide:null,onRemove:null,onSelectAll:null,onShow:null,optionDisabled:null,optionGroupChildren:null,optionGroupLabel:null,optionGroupTemplate:null,optionLabel:null,optionValue:null,options:null,overlayVisible:!1,panelClassName:null,panelFooterTemplate:null,panelHeaderTemplate:null,panelStyle:null,placeholder:null,removeIcon:null,resetFilterOnHide:!1,scrollHeight:"200px",selectAll:!1,selectedItemTemplate:null,selectedItemsLabel:"{0} items selected",selectionLimit:null,showClear:!1,showSelectAll:!0,style:null,tabIndex:0,tooltip:null,tooltipOptions:null,transitionOptions:null,useOptionAsValue:!1,value:null,virtualScrollerOptions:null,children:void 0},css:{classes:{root:function(e){var t=e.props,n=e.focusedState,l=e.overlayVisibleState;return v("p-multiselect p-component p-inputwrapper",{"p-multiselect-chip":"chip"===t.display,"p-disabled":t.disabled,"p-multiselect-clearable":t.showClear&&!t.disabled,"p-focus":n,"p-inputwrapper-filled":h.isNotEmpty(t.value),"p-inputwrapper-focus":n||l})},label:function(e){var t=e.props,n=e.empty;return v("p-multiselect-label",{"p-placeholder":n&&t.placeholder,"p-multiselect-label-empty":n&&!t.placeholder&&!t.selectedItemTemplate,"p-multiselect-items-label":!n&&"chip"!==t.display&&t.value.length>t.maxSelectedLabels})},panel:function(e){var n=e.panelProps,l=e.context;return v("p-multiselect-panel p-component",{"p-multiselect-inline":n.inline,"p-multiselect-flex":n.flex,"p-multiselect-limited":!e.allowOptionSelect,"p-input-filled":l&&"filled"===l.inputStyle||"filled"===t.inputStyle,"p-ripple-disabled":l&&!1===l.ripple||!1===t.ripple})},list:function(e){return"p-multiselect-items p-component"},labelContainer:"p-multiselect-label-container",triggerIcon:"p-multiselect-trigger-icon p-c",trigger:"p-multiselect-trigger",clearIcon:"p-multiselect-clear-icon",tokenLabel:"p-multiselect-token-label",token:"p-multiselect-token",removeTokenIcon:"p-multiselect-token-icon",wrapper:"p-multiselect-items-wrapper",emptyMessage:"p-multiselect-empty-message",itemGroup:"p-multiselect-item-group",closeButton:"p-multiselect-close p-link",header:"p-multiselect-header",closeIcon:"p-multiselect-close-icon",headerCheckboxContainer:"p-multiselect-select-all",headerCheckboxIcon:"p-multiselect-select-all p-checkbox-icon p-c",headerSelectAllLabel:"p-multiselect-select-all-label",filterContainer:"p-multiselect-filter-container",filterIcon:"p-multiselect-filter-icon",item:function(e){var t=e.itemProps;return v("p-multiselect-item",{"p-highlight":t.selected,"p-disabled":t.disabled})},checkboxContainer:"p-checkbox p-component",checkboxIcon:"p-checkbox-icon p-c",checkbox:function(e){return v("p-checkbox-box",{"p-highlight":e.itemProps.selected})},transition:"p-connected-overlay"},styles:"\n@layer primereact {\n    .p-multiselect {\n        display: inline-flex;\n        user-select: none;\n        cursor: pointer;\n    }\n    \n    .p-multiselect-trigger {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        flex-shrink: 0;\n        cursor: pointer;\n    }\n    \n    .p-multiselect-label-container {\n        overflow: hidden;\n        flex: 1 1 auto;\n        cursor: pointer;\n    }\n    \n    .p-multiselect-label  {\n        display: block;\n        white-space: nowrap;\n        cursor: pointer;\n        overflow: hidden;\n        text-overflow: ellipsis;\n    }\n    \n    .p-multiselect-label-empty {\n        overflow: hidden;\n        visibility: hidden;\n    }\n    \n    .p-multiselect-token {\n        cursor: default;\n        display: inline-flex;\n        align-items: center;\n        flex: 0 0 auto;\n    }\n    \n    .p-multiselect-token-icon {\n        cursor: pointer;\n    }\n    \n    .p-multiselect .p-multiselect-panel {\n        min-width: 100%;\n    }\n    \n    .p-multiselect-inline.p-multiselect-panel {\n        border: none;\n        position: initial;\n        background: none;\n        box-shadow: none;\n    }\n    \n    .p-multiselect-inline.p-multiselect-panel .p-multiselect-items {\n        padding: 0;\n    }\n    \n    .p-multiselect-flex.p-multiselect-panel .p-multiselect-items {\n        display: flex;\n        flex-wrap: wrap;\n    }\n    \n    .p-multiselect-items-wrapper {\n        overflow: auto;\n    }\n    \n    .p-multiselect-items {\n        margin: 0;\n        padding: 0;\n        list-style-type: none;\n    }\n    \n    .p-multiselect-item {\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        font-weight: normal;\n        white-space: nowrap;\n        position: relative;\n        overflow: hidden;\n    }\n    \n    .p-multiselect-header {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n    }\n    \n    .p-multiselect-select-all-label {\n        margin-left: 0.5rem;\n    }\n    \n    .p-multiselect-filter-container {\n        position: relative;\n        flex: 1 1 auto;\n    }\n    \n    .p-multiselect-filter-icon {\n        position: absolute;\n        top: 50%;\n        margin-top: -.5rem;\n    }\n    \n    .p-multiselect-filter-container .p-inputtext {\n        width: 100%;\n    }\n    \n    .p-multiselect-close {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        flex-shrink: 0;\n        overflow: hidden;\n        position: relative;\n        margin-left: auto;\n    }\n    \n    .p-multiselect-clear-icon {\n        position: absolute;\n        top: 50%;\n        margin-top: -.5rem;\n    }\n    \n    .p-fluid .p-multiselect {\n        display: flex;\n    }\n}\n",inlineStyles:{root:function(e){var t=e.props;return t.showClear&&!t.disabled&&{position:"relative"}},itemGroup:function(e){var t=e.scrollerOptions;return{height:t.props?t.props.itemSize:void 0}}}}}),q=o.extend({defaultProps:{__TYPE:"Checkbox",autoFocus:!1,checked:!1,className:null,disabled:!1,falseValue:!1,icon:null,id:null,inputId:null,inputRef:null,name:null,onChange:null,onClick:null,onContextMenu:null,onMouseDown:null,readOnly:!1,required:!1,style:null,tabIndex:null,tooltip:null,tooltipOptions:null,trueValue:!0,value:null,children:void 0},css:{classes:{icon:"p-checkbox-icon p-c",input:function(e){return v("p-checkbox-box",{"p-highlight":e.checked,"p-disabled":e.props.disabled,"p-focus":e.focusedState})},root:function(e){return v("p-checkbox p-component",{"p-checkbox-checked":e.checked,"p-checkbox-disabled":e.props.disabled,"p-checkbox-focused":e.focusedState})}},styles:"\n.p-checkbox {\n    display: inline-flex;\n    cursor: pointer;\n    user-select: none;\n    vertical-align: bottom;\n    position: relative;\n}\n\n.p-checkbox.p-checkbox-disabled {\n    cursor: auto;\n}\n\n.p-checkbox-box {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}        \n"}});function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var W=e.memo(e.forwardRef((function(t,l){var r=e.useContext(n),o=q.getProps(t,r),u=_(e.useState(!1),2),s=u[0],p=u[1],m=q.setMetaData({props:o,state:{focused:s},context:{checked:o.checked===o.trueValue,disabled:o.disabled}}),f=m.ptm,d=m.cx;i(q.css.styles,m.isUnstyled,{name:"checkbox",styled:!0});var x=e.useRef(null),k=e.useRef(o.inputRef),E=function(e){if(!o.disabled&&!o.readOnly&&(o.onChange||o.onClick)){var t=S(),n=e.target instanceof HTMLDivElement||e.target instanceof HTMLSpanElement||e.target instanceof Object;if(e.target===k.current||n&&e.target.checked!==t){var l=t?o.falseValue:o.trueValue,r={originalEvent:e,value:o.value,checked:l,stopPropagation:function(){e.stopPropagation()},preventDefault:function(){e.preventDefault()},target:{type:"checkbox",name:o.name,id:o.id,value:o.value,checked:l}};if(o.onClick&&o.onClick(r),e.defaultPrevented)return;o.onChange&&o.onChange(r)}y.focus(k.current),e.preventDefault()}},S=function(){return o.checked===o.trueValue};e.useImperativeHandle(l,(function(){return{props:o,focus:function(){return y.focus(k.current)},getElement:function(){return x.current},getInput:function(){return k.current}}})),e.useEffect((function(){h.combinedRefs(k,o.inputRef)}),[k,o.inputRef]),a((function(){k.current.checked=S()}),[o.checked,o.trueValue]),c((function(){o.autoFocus&&y.focus(k.current,o.autoFocus)}));var I=S(),C=h.isNotEmpty(o.tooltip),N=q.getOtherProps(o),P=h.reduceKeys(N,y.ARIA_PROPS),D=g({className:d("icon")},f("icon")),A=O.getJSXIcon(I?o.icon||e.createElement(w,D):null,z({},D),{props:o,checked:I}),L=g({id:o.id,className:v(o.className,d("root",{checked:I,focusedState:s})),style:o.style,onClick:function(e){return E(e)},onContextMenu:o.onContextMenu,onMouseDown:o.onMouseDown},N,f("root")),F=g({className:"p-hidden-accessible"},f("hiddenInputWrapper")),T=g(z({id:o.inputId,type:"checkbox",name:o.name,tabIndex:o.tabIndex,defaultChecked:I,onFocus:function(e){p(!0)},onBlur:function(e){p(!1)},onKeyDown:function(e){var t;"Space"!==(t=e).code&&" "!==t.key||E(t)},disabled:o.disabled,readOnly:o.readOnly,required:o.required},P),f("hiddenInput")),M=g({className:d("input",{checked:I,focusedState:s}),"data-p-highlight":I,"data-p-disabled":o.disabled,"data-p-focus":s},f("input"));return e.createElement(e.Fragment,null,e.createElement("div",j({ref:x},L),e.createElement("div",F,e.createElement("input",j({ref:k},T))),e.createElement("div",M,A)),C&&e.createElement(b,j({target:x,content:o.tooltip},o.tooltipOptions,{pt:f("tooltip")})))})));function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}W.displayName="Checkbox";var $=e.memo((function(t){var n=t.ptm,r=t.cx,o=t.isUnstyled,i={filter:function(e){return c(e)},reset:function(){return t.resetFilter()}},a=function(e,l){return n(e,Z({hostName:t.hostName},l))},c=function(e){t.onFilter&&t.onFilter({originalEvent:e,query:e.target.value})},u=function(e){t.onSelectAll&&t.onSelectAll({originalEvent:e,checked:t.selectAll}),e.preventDefault(),e.stopPropagation()},s=function(){var l=g({className:r("filterIcon")},a("filterIcon")),o=O.getJSXIcon(t.filterIcon||e.createElement(C,l),Z({},l),{props:t});if(t.filter){var u=g({className:r("filterContainer")},a("filterContainer")),s=e.createElement("div",u,e.createElement(N,{ref:t.filterRef,type:"text",role:"textbox",value:t.filterValue,onChange:c,className:"p-multiselect-filter",placeholder:t.filterPlaceholder,pt:n("filterInput"),__parentMetadata:{parent:t.metaData}}),o);if(t.filterTemplate)s=h.getJSXElement(t.filterTemplate,{className:u.className,element:s,filterOptions:i,onFilter:c,filterIconClassName:t.filterIconClassName,props:t});return e.createElement(e.Fragment,null,s)}return null}(),p=t.id?t.id+"_selectall":x(),f=g({htmlFor:p,className:r("headerSelectAllLabel")},a("headerSelectAllLabel")),d=g({className:r("headerCheckboxIcon")},a("headerCheckboxIcon")),b=O.getJSXIcon(t.itemCheckboxIcon||e.createElement(w,d),Z({},d),{selected:t.selected}),v=t.showSelectAll&&e.createElement("div",{className:"p-multiselect-select-all"},e.createElement(W,{id:p,checked:t.selectAll,onChange:u,role:"checkbox","aria-checked":t.selectAll,icon:b,pt:n("headercheckbox"),unstyled:o()}),!t.filter&&e.createElement("label",f,t.selectAllLabel)),y=g({className:r("closeIcon"),"aria-hidden":!0},a("closeIcon")),k=O.getJSXIcon(t.closeIcon||e.createElement(m,y),Z({},y),{props:t}),E=g({className:r("header")},a("header")),S=g({type:"button",className:r("closeButton"),"aria-label":l("close"),onClick:t.onClose},a("closeButton")),I=e.createElement("button",S,k,e.createElement(P,null)),j=e.createElement("div",E,v,s,I);return t.template?h.getJSXElement(t.template,{className:"p-multiselect-header",checkboxElement:v,checked:t.selectAll,onChange:u,filterElement:s,closeElement:I,closeElementClassName:"p-multiselect-close p-link",closeIconClassName:"p-multiselect-close-icon",onCloseClick:t.onClose,element:j,itemCheckboxIcon:b,props:t}):j}));function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}$.displayName="MultiSelectHeader";var te=e.memo((function(t){var n=t.ptm,l=t.cx,r=function(e){return n(e,{hostName:t.hostName,context:{selected:t.selected}})},o=g({className:l("checkboxIcon")},r("checkboxIcon")),i=t.selected?O.getJSXIcon(t.checkboxIcon||e.createElement(w,o),ee({},o),{selected:t.selected}):null,a=t.template?h.getJSXElement(t.template,t.option):t.label,c=t.disabled?null:t.tabIndex||0,u=g({className:l("checkboxContainer")},r("checkboxContainer")),s=g({className:l("checkbox",{itemProps:t}),"data-p-highlight":t.selected},r("checkbox")),p=g({className:v(t.className,t.option.className,l("item",{itemProps:t})),style:t.style,onClick:function(e){t.onClick&&t.onClick({originalEvent:e,option:t.option}),e.preventDefault(),e.stopPropagation()},tabIndex:c,onKeyDown:function(e){t.onKeyDown&&t.onKeyDown({originalEvent:e,option:t.option})},role:"option","aria-selected":t.selected,"data-p-highlight":t.selected,"data-p-disabled":t.disabled},r("item"));return e.createElement("li",p,e.createElement("div",u,e.createElement("div",s,i)),e.createElement("span",null,a),e.createElement(P,null))}));function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}te.displayName="MultiSelectItem";var re=e.memo(e.forwardRef((function(t,r){var o=e.useRef(null),i=e.useRef(null),a=e.useContext(n),c=t.ptm,u=t.cx,s=t.sx,p=t.isUnstyled,m=function(e,n){return c(e,le({hostName:t.hostName},n))},f=function(){t.onEnter((function(){if(o.current){var e=t.getSelectedOptionIndex();-1!==e&&setTimeout((function(){return o.current.scrollToIndex(e)}),0)}}))},d=function(){t.onEntered((function(){t.filter&&t.filterInputAutoFocus&&i.current&&y.focus(i.current,!1)}))},b=function(e){o.current&&o.current.scrollToIndex(0),t.onFilterInputChange&&t.onFilterInputChange(e)},O=function(){if(t.panelFooterTemplate){var n=h.getJSXElement(t.panelFooterTemplate,t,t.onOverlayHide);return e.createElement("div",{className:"p-multiselect-footer"},n)}return null},x=function(n,l){return t.getOptionGroupChildren(n).map((function(n,r){var o=t.getOptionLabel(n),i=r+"_"+t.getOptionRenderKey(n),a=t.isOptionDisabled(n),s=a?null:t.tabIndex||0,p=t.isSelected(n);return e.createElement(te,{hostName:t.hostName,key:i,label:o,option:n,style:l,template:t.itemTemplate,selected:p,onClick:t.onOptionSelect,onKeyDown:t.onOptionKeyDown,tabIndex:s,disabled:a,className:t.itemClassName,checkboxIcon:t.checkboxIcon,ptm:c,cx:u})}))},k=function(){var n=h.getJSXElement(t.emptyFilterMessage,t)||l("emptyFilterMessage"),r=g({className:u("emptyMessage")},m("emptyMessage"));return e.createElement("li",r,n)},w=function(n,l){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o={height:r.props?r.props.itemSize:void 0};if(t.optionGroupLabel){var i=t.optionGroupTemplate?h.getJSXElement(t.optionGroupTemplate,n,l):t.getOptionGroupLabel(n),a=x(n,o),p=l+"_"+t.getOptionGroupRenderKey(n),f=g({className:u("itemGroup"),style:s("itemGroup",{scrollerOptions:r})},m("itemGroup"));return e.createElement(e.Fragment,{key:p},e.createElement("li",f,i),a)}var d=t.getOptionLabel(n),b=l+"_"+t.getOptionRenderKey(n),v=t.isOptionDisabled(n),y=v?null:t.tabIndex||0,O=t.isSelected(n);return e.createElement(te,{hostName:t.hostName,key:b,label:d,option:n,style:o,template:t.itemTemplate,selected:O,onClick:t.onOptionSelect,onKeyDown:t.onOptionKeyDown,tabIndex:y,disabled:v,className:t.itemClassName,checkboxIcon:t.checkboxIcon,ptm:c,cx:u})},C=function(){if(t.virtualScrollerOptions){var n=le(le({},t.virtualScrollerOptions),{style:le(le({},t.virtualScrollerOptions.style),{height:t.scrollHeight}),className:v("p-multiselect-items-wrapper",t.virtualScrollerOptions.className),items:t.visibleOptions,autoSize:!0,onLazyLoad:function(e){return t.virtualScrollerOptions.onLazyLoad(le(le({},e),{filter:t.filterValue}))},itemTemplate:function(e,t){return e&&w(e,t.index,t)},contentTemplate:function(n){var l=t.visibleOptions&&t.visibleOptions.length||!t.hasFilter?n.children:k(),r=g({ref:n.contentRef,style:n.style,className:v(n.className,u("list",{virtualScrollerProps:t.virtualScrollerOptions})),role:"listbox","aria-multiselectable":!0},m("list"));return e.createElement("ul",r,l)}});return e.createElement(I,j({ref:o},n,{pt:c("virtualScroller"),__parentMetadata:{parent:t.metaData}}))}var r,i,a=h.isNotEmpty(t.visibleOptions)?t.visibleOptions.map(w):t.hasFilter?k():(r=h.getJSXElement(t.emptyMessage,t)||l("emptyMessage"),i=g({className:u("emptyMessage")},m("emptyMessage")),e.createElement("li",i,r)),s=g({className:u("wrapper"),style:{maxHeight:t.scrollHeight}},m("wrapper")),p=g({className:u("list"),role:"listbox","aria-multiselectable":!0},m("list"));return e.createElement("div",s,e.createElement("ul",p,a))},N=function(){var n=t.allowOptionSelect(),l=e.createElement($,{hostName:t.hostName,id:t.id,filter:t.filter,filterRef:i,filterValue:t.filterValue,filterTemplate:t.filterTemplate,onFilter:b,filterPlaceholder:t.filterPlaceholder,onClose:t.onCloseClick,showSelectAll:t.showSelectAll,selectAll:t.isAllSelected(),selectAllLabel:t.selectAllLabel,onSelectAll:t.onSelectAll,template:t.panelHeaderTemplate,resetFilter:t.resetFilter,closeIcon:t.closeIcon,filterIcon:t.filterIcon,itemCheckboxIcon:t.itemCheckboxIcon,ptm:c,cx:u,isUnstyled:p,metaData:t.metaData}),o=C(),s=O(),h=g({className:v(t.panelClassName,u("panel",{panelProps:t,context:a,allowOptionSelect:n})),style:t.panelStyle,onClick:t.onClick},m("panel"));if(t.inline)return e.createElement("div",j({ref:r},h),o,s);var y=g({classNames:u("transition"),in:t.in,timeout:{enter:120,exit:100},options:t.transitionOptions,unmountOnExit:!0,onEnter:f,onEntered:d,onExit:t.onExit,onExited:t.onExited},m("transition"));return e.createElement(E,j({nodeRef:r},y),e.createElement("div",j({ref:r},h),l,o,s))}();return t.inline?N:e.createElement(S,{element:N,appendTo:t.appendTo})})));function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ae(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ce(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var l=0,r=function(){};return{s:r,n:function(){return l>=e.length?{done:!0}:{done:!1,value:e[l++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(a)throw o}}}}function ce(e,t){if(e){if("string"==typeof e)return ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ue(e,t):void 0}}function ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,l=new Array(t);n<t;n++)l[n]=e[n];return l}re.displayName="MultiSelectPanel";var se=e.memo(e.forwardRef((function(l,o){var x=e.useContext(n),E=B.getProps(l,x),S=_(e.useState(""),2),I=S[0],w=S[1],C=_(e.useState(!1),2),N=C[0],P=C[1],D=_(e.useState(E.inline),2),A=D[0],L=D[1],T=e.useRef(null),M=e.useRef(E.inputRef),R=e.useRef(null),V=e.useRef(null),G=I&&I.trim().length>0,H=h.isEmpty(E.value),J=E.optionValue?null:E.dataKey,X={props:E,state:{filterState:I,focused:N,overlayVisible:A}},q=B.setMetaData(X),U=q.ptm,z=q.cx,W=q.sx,Y=q.isUnstyled;i(B.css.styles,Y,{name:"multiselect"});var Z=_(u({target:T,overlay:V,listener:function(e,t){t.valid&&("outside"===t.type?!me(e)&&!fe(e)&&se():se())},when:A}),2),$=Z[0],Q=Z[1],ee=function(){return!E.selectionLimit||!E.value||E.value&&E.value.length<E.selectionLimit},te=function(e){var t=e.originalEvent,n=e.option;if(!E.disabled&&!ke(n)){var l=Oe(n),r=Ee(n),o=ve(n),i=ee();o?oe(t,E.value.filter((function(e){return!h.equals(r?e:Oe(e),l,J)})),n):i&&oe(t,[].concat(K(E.value||[]),[l]),n)}},ne=function e(t){var n=t.nextElementSibling;return n?!0===y.getAttribute(n,"data-p-disabled")||"itemgroup"===y.getAttribute(n,"data-pc-section")?e(n):n:null},le=function e(t){var n=t.previousElementSibling;return n?!0===y.getAttribute(n,"data-p-disabled")||"itemgroup"===y.getAttribute(n,"data-pc-section")?e(n):n:null},oe=function(e,t,n){E.onChange&&E.onChange({originalEvent:e,value:t,selectedOption:n,stopPropagation:function(){e.stopPropagation()},preventDefault:function(){e.preventDefault()},target:{name:E.name,id:E.id,value:t}})},ce=function(){w(""),E.onFilter&&E.onFilter({filter:""})},ue=function(){L(!0)},se=function(){L(!1)},pe=function(){y.alignOverlay(V.current,R.current.parentElement,E.appendTo||x&&x.appendTo||t.appendTo)},me=function(e){return"clearicon"===y.getAttribute(e.target,"data-pc-section")},fe=function(e){return"headercheckboxcontainer"===y.getAttribute(e.target,"data-pc-section")},de=function(e){return V.current&&V.current.contains(e.target)},be=function(e,t){return t.findIndex((function(t){return e.some((function(e){return h.equals(e,Oe(t),J)}))}))},ve=function(e){if(E.value){var t=Oe(e),n=Ee(e);return E.value.some((function(e){return h.equals(n?e:Oe(e),t,J)}))}return!1},he=function(e){var t;if(E.options)if(E.optionGroupLabel){var n,l=ae(E.options);try{for(l.s();!(n=l.n()).done;){if(t=ye(e,xe(n.value)))break}}catch(e){l.e(e)}finally{l.f()}}else t=ye(e,E.options),h.isEmpty(t)&&(t=ye(e,E.value));return t?ge(t):null},ye=function(e,t){return t.find((function(t){return h.equals(Oe(t),e,J)}))},ge=function(e){return E.optionLabel?h.resolveFieldData(e,E.optionLabel):e&&void 0!==e.label?e.label:e},Oe=function(e){if(E.useOptionAsValue)return e;if(E.optionValue){var t=h.resolveFieldData(e,E.optionValue);return null!==t?t:e}return e&&void 0!==e.value?e.value:e},xe=function(e){return h.resolveFieldData(e,E.optionGroupChildren)},ke=function(e){return E.optionDisabled?h.isFunction(E.optionDisabled)?E.optionDisabled(e):h.resolveFieldData(e,E.optionDisabled):!(!e||void 0===e.disabled)&&e.disabled},Ee=function(e){return!E.useOptionAsValue&&E.optionValue||e&&void 0!==e.value},Se=function(e,t){var n=E.value.filter((function(e){return!h.equals(e,t,J)}));E.onRemove&&E.onRemove({originalEvent:e,value:n}),oe(e,n,t)},Ie=function(){var e=/{(.*?)}/;return e.test(E.selectedItemsLabel)?E.selectedItemsLabel.replace(E.selectedItemsLabel.match(e)[0],E.value.length+""):E.selectedItemsLabel},we=function(){if(!H&&!E.fixedPlaceholder)return h.isNotEmpty(E.maxSelectedLabels)&&E.value.length>E.maxSelectedLabels?Ie():h.isArray(E.value)?E.value.reduce((function(e,t,n){return e+(0!==n?", ":"")+he(t)}),""):""};e.useImperativeHandle(o,(function(){return{props:E,show:ue,hide:se,focus:function(){return y.focus(M.current)},getElement:function(){return T.current},getOverlay:function(){return V.current},getInput:function(){return M.current}}})),c((function(){pe()})),e.useEffect((function(){h.combinedRefs(M,E.inputRef)}),[M,E.inputRef]),e.useEffect((function(){setTimeout((function(){E.overlayVisible?ue():se()}),100)}),[E.overlayVisible]),a((function(){A&&I&&G&&pe()}),[A,I,G]),s((function(){k.clear(V.current)}));var Ce,Ne,Pe,je=function(){if(G){var e=I.trim().toLocaleLowerCase(E.filterLocale),t=E.filterBy?E.filterBy.split(","):[E.optionLabel||"label"];if(E.optionGroupLabel){var n,l=[],o=ae(E.options);try{for(o.s();!(n=o.n()).done;){var i=n.value,a=r.filter(xe(i),t,e,E.filterMatchMode,E.filterLocale);a&&a.length&&l.push(ie(ie({},i),F({},E.optionGroupChildren,a)))}}catch(e){o.e(e)}finally{o.f()}return l}return r.filter(E.options,t,e,E.filterMatchMode,E.filterLocale)}return E.options}(),De=h.isNotEmpty(E.tooltip),Ae=B.getOtherProps(E),Le=h.reduceKeys(Ae,y.ARIA_PROPS),Fe=g({className:z("triggerIcon")},U("triggerIcon")),Te=g({className:z("trigger")},U("trigger")),Me=e.createElement("div",Te,E.dropdownIcon?O.getJSXIcon(E.dropdownIcon,ie({},Fe),{props:E}):e.createElement(p,Fe)),Re=!E.inline&&(Ce=E.selectedItemTemplate?H?h.getJSXElement(E.selectedItemTemplate):h.isNotEmpty(E.maxSelectedLabels)&&E.value.length>E.maxSelectedLabels?Ie():E.value.map((function(t,n){var l=h.getJSXElement(E.selectedItemTemplate,t);return e.createElement(e.Fragment,{key:n},l)})):"chip"!==E.display||H?we():E.value.slice(0,E.maxSelectedLabels||E.value.length).map((function(t,n){var l=he(t),r=g({key:n,className:z("removeTokenIcon"),onClick:function(e){return Se(e,t)}},U("removeTokenIcon")),o=!E.disabled&&(E.removeIcon?O.getJSXIcon(E.removeIcon,ie({},r),{props:E}):e.createElement(f,r)),i=g({className:z("token")},U("token")),a=g({key:l+n,className:z("tokenLabel")},U("tokenLabel"));return e.createElement("div",j({},i,{key:l}),e.createElement("span",a,l),o)})),Ne=g({ref:R,className:z("labelContainer")},U("labelContainer")),Pe=g({className:z("label",{empty:H})},U("label")),e.createElement("div",Ne,e.createElement("div",Pe,Ce||E.placeholder||"empty"))),Ve=!E.inline&&function(){var t=g({className:z("clearIcon"),onClick:function(e){return oe(e,[],[])}},U("clearIcon")),n=O.getJSXIcon(E.clearIcon||e.createElement(m,t),ie({},t),{props:E});return H||!E.showClear||E.disabled?null:n}(),Ge=g(ie(ie({ref:T,id:E.id,style:ie(ie({},E.style),W("root")),className:v(E.className,z("root",{focusedState:N,overlayVisibleState:A}))},Ae),{},{onClick:function(e){E.inline||E.disabled||de(e)||"removetokenicon"===y.getAttribute(e.target,"data-pc-section")||me(e)||(A?se():ue(),y.focus(M.current),e.preventDefault())}}),B.getOtherProps(E),U("root")),Ke=g({className:"p-hidden-accessible"},U("hiddenInputWrapper")),He=g(ie({ref:M,id:E.inputId,name:E.name,type:"text",onFocus:function(e){P(!0),E.onFocus&&E.onFocus(e)},onBlur:function(e){P(!1),E.onBlur&&E.onBlur(e)},onKeyDown:function(e){switch(e.which){case 40:if(E.inline)break;!A&&e.altKey&&(ue(),e.preventDefault());break;case 32:if(E.inline)break;A?se():ue(),e.preventDefault();break;case 27:if(E.inline)break;se();break;case 9:if(A){var t=y.getFirstFocusableElement(V.current);t&&(t.focus(),e.preventDefault())}}},role:"listbox","aria-expanded":A,disabled:E.disabled,tabIndex:E.tabIndex},Le),U("input"));return e.createElement(e.Fragment,null,e.createElement("div",Ge,e.createElement("div",Ke,e.createElement("input",j({},He,{readOnly:!0}))),!E.inline&&e.createElement(e.Fragment,null,Re,Ve,Me),e.createElement(re,j({hostName:"MultiSelect",ref:V,visibleOptions:je},E,{onClick:function(e){d.emit("overlay-click",{originalEvent:e,target:T.current})},onOverlayHide:se,filterValue:I,hasFilter:G,onFilterInputChange:function(e){var t=e.query;w(t),E.onFilter&&E.onFilter({originalEvent:e,filter:t})},resetFilter:ce,onCloseClick:function(e){se(),y.focus(M.current),e.preventDefault(),e.stopPropagation()},onSelectAll:function(e){if(E.onSelectAll)E.onSelectAll(e);else{var t=null;if(e.checked){if(t=[],je){var n=je.filter((function(e){return ke(e)&&ve(e)}));t=n.map((function(e){return Oe(e)}))}}else if(je){var l=je.filter((function(e){return!ke(e)||ve(e)}));E.optionGroupLabel?(t=[],l.forEach((function(e){return t=[].concat(K(t),K(xe(e).filter((function(e){return!ke(e)})).map((function(e){return Oe(e)}))))}))):t=l.map((function(e){return Oe(e)}))}oe(e.originalEvent,t,t)}},getOptionLabel:ge,getOptionRenderKey:function(e){return E.dataKey?h.resolveFieldData(e,E.dataKey):ge(e)},isOptionDisabled:ke,getOptionGroupChildren:xe,getOptionGroupLabel:function(e){return h.resolveFieldData(e,E.optionGroupLabel)},getOptionGroupRenderKey:function(e){return h.resolveFieldData(e,E.optionGroupLabel)},isSelected:ve,getSelectedOptionIndex:function(){if(null!=E.value&&E.options){if(E.optionGroupLabel){var e=0,t=E.options.findIndex((function(t,n){return(e=n)&&-1!==be(E.value,xe(t))}));return-1!==t?{group:e,option:t}:-1}return be(E.value,E.options)}return-1},isAllSelected:function(){if(E.onSelectAll)return E.selectAll;if(h.isEmpty(je))return!1;var e=je.filter((function(e){return!ke(e)}));if(E.optionGroupLabel){var t,n=!0,l=ae(e);try{for(l.s();!(t=l.n()).done;){!0===xe(t.value).filter((function(e){return!ke(e)})).some((function(e){return!ve(e)}))&&(n=!1)}}catch(e){l.e(e)}finally{l.f()}return n}return!e.some((function(e){return!ve(e)}))},onOptionSelect:te,allowOptionSelect:ee,onOptionKeyDown:function(e){var t=e.originalEvent,n=t.currentTarget;switch(t.which){case 40:var l=ne(n);l&&l.focus(),t.preventDefault();break;case 38:var r=le(n);r&&r.focus(),t.preventDefault();break;case 13:case 32:te(e),t.preventDefault();break;case 27:se(),y.focus(M.current)}},in:A,onEnter:function(e){var n;k.set("overlay",V.current,x&&x.autoZIndex||t.autoZIndex,x&&x.zIndex.overlay||t.zIndex.overlay),y.addStyles(V.current,{position:"absolute",top:"0",left:"0"}),pe(),(n=y.findSingle(V.current,"li.p-highlight"))&&n.scrollIntoView&&n.scrollIntoView({block:"nearest",inline:"nearest"}),e&&e()},onEntered:function(e){e&&e(),$(),E.onShow&&E.onShow()},onExit:function(){Q()},onExited:function(){E.filter&&E.resetFilterOnHide&&ce(),k.clear(V.current),E.onHide&&E.onHide()},ptm:U,cx:z,sx:W,isUnstyled:Y,metaData:X}))),De&&e.createElement(b,j({target:T,content:E.tooltip},E.tooltipOptions,{pt:U("tooltip")})))})));se.displayName="MultiSelect";export{se as MultiSelect};
