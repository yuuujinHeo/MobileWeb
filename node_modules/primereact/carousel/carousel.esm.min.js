import*as e from"react";import t,{PrimeReactContext as n,ariaLabel as r}from"primereact/api";import{ComponentBase as a,useHandleStyle as o}from"primereact/componentbase";import{usePrevious as l,useResizeListener as i,useMountEffect as c,useUpdateEffect as u}from"primereact/hooks";import{ChevronDownIcon as s}from"primereact/icons/chevrondown";import{ChevronLeftIcon as p}from"primereact/icons/chevronleft";import{ChevronRightIcon as m}from"primereact/icons/chevronright";import{ChevronUpIcon as f}from"primereact/icons/chevronup";import{Ripple as v}from"primereact/ripple";import{classNames as d,mergeProps as y,UniqueComponentId as h,DomHandler as b,ObjectUtils as g,IconUtils as x}from"primereact/utils";function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function w(e,t){if("object"!==S(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function I(e){var t=w(e,"string");return"symbol"===S(t)?t:String(t)}function N(){return N=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},N.apply(this,arguments)}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function E(e){if(Array.isArray(e))return C(e)}function O(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function P(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}function j(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function k(e){if(Array.isArray(e))return e}function B(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,l,i=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw a}}return i}}function T(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function A(e,t){return k(e)||B(e,t)||P(e,t)||T()}var V=a.extend({defaultProps:{__TYPE:"Carousel",id:null,value:null,page:0,header:null,footer:null,style:null,className:null,itemTemplate:null,circular:!1,showIndicators:!0,showNavigators:!0,autoplayInterval:0,numVisible:1,numScroll:1,prevIcon:null,nextIcon:null,responsiveOptions:null,orientation:"horizontal",verticalViewPortHeight:"300px",contentClassName:null,containerClassName:null,indicatorsContentClassName:null,onPageChange:null,children:void 0},css:{classes:{root:function(e){var t=e.isVertical;return d("p-carousel p-component",{"p-carousel-vertical":t,"p-carousel-horizontal":!t})},container:"p-carousel-container",content:"p-carousel-content",indicators:"p-carousel-indicators p-reset",header:"p-carousel-header",footer:"p-carousel-footer",itemsContainer:"p-carousel-items-container",itemsContent:"p-carousel-items-content",previousButton:function(e){return d("p-carousel-prev p-link",{"p-disabled":e.isDisabled})},previousButtonIcon:"p-carousel-prev-icon",nextButton:function(e){return d("p-carousel-next p-link",{"p-disabled":e.isDisabled})},nextButtonIcon:"p-carousel-next-icon",indicator:function(e){return d("p-carousel-indicator",{"p-highlight":e.isActive})},indicatorButton:"p-link",itemCloned:function(e){var t=e.itemProps;return d(t.className,"p-carousel-item",{"p-carousel-item-active":t.active,"p-carousel-item-start":t.start,"p-carousel-item-end":t.end})},item:function(e){var t=e.itemProps;return d(t.className,"p-carousel-item",{"p-carousel-item-active":t.active,"p-carousel-item-start":t.start,"p-carousel-item-end":t.end})}},styles:"\n@layer primereact {\n    .p-carousel {\n        display: flex;\n        flex-direction: column;\n    }\n    \n    .p-carousel-content {\n        display: flex;\n        flex-direction: column;\n        overflow: auto;\n    }\n    \n    .p-carousel-prev,\n    .p-carousel-next {\n        align-self: center;\n        flex-grow: 0;\n        flex-shrink: 0;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        overflow: hidden;\n        position: relative;\n    }\n    \n    .p-carousel-container {\n        display: flex;\n        flex-direction: row;\n    }\n    \n    .p-carousel-items-content {\n        overflow: hidden;\n        width: 100%;\n    }\n    \n    .p-carousel-items-container {\n        display: flex;\n        flex-direction: row;\n    }\n    \n    .p-carousel-indicators {\n        display: flex;\n        flex-direction: row;\n        justify-content: center;\n        flex-wrap: wrap;\n    }\n    \n    .p-carousel-indicator > button {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n    \n    /* Vertical */\n    .p-carousel-vertical .p-carousel-container {\n        flex-direction: column;\n    }\n    \n    .p-carousel-vertical .p-carousel-items-container {\n        flex-direction: column;\n        height: 100%;\n    }\n    \n    /* Keyboard Support */\n    .p-items-hidden .p-carousel-item {\n        visibility: hidden;\n    }\n    \n    .p-items-hidden .p-carousel-item.p-carousel-item-active {\n        visibility: visible;\n    }\n}\n",inlineStyles:{itemsContent:function(e){return{height:e.height}}}}});function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){var r,a,o;r=e,o=n[t],(a=I(a=t))in r?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M=e.memo((function(t){var n=t.ptm,r=t.cx,a=t.className&&"p-carousel-item-cloned"===t.className?"itemCloned":"item",o=t.template(t.item),l=y({className:r(a,{itemProps:t}),"data-p-carousel-item-active":t.active,"data-p-carousel-item-start":t.start,"data-p-carousel-item-end":t.end},n(a));return e.createElement("div",l,o)})),H=e.memo(e.forwardRef((function(a,S){var w=e.useContext(n),I=V.getProps(a,w),C=A(e.useState(I.numVisible),2),k=C[0],B=C[1],T=A(e.useState(I.numScroll),2),D=T[0],H=T[1],L=A(e.useState(I.page*I.numScroll*-1),2),X=L[0],_=L[1],Y=A(e.useState(I.page),2),z=Y[0],J=Y[1],U=V.setMetaData({props:I,state:{numVisible:k,numScroll:D,totalShiftedItems:X,page:z}}),F=U.ptm,K=U.cx,W=U.sx,$=U.isUnstyled;o(V.css.styles,$,{name:"carousel"});var q=e.useRef(null),G=e.useRef(null),Q=e.useRef(0),Z=e.useRef(!!I.autoplayInterval),ee=e.useRef(""),te=e.useRef(20),ne=e.useRef(null),re=e.useRef(null),ae=e.useRef(null),oe=e.useRef(!1),le=e.useRef(null),ie=l(D),ce=l(k),ue=l(I.value),se=l(I.page),pe="vertical"===I.orientation,me=I.circular||!!I.autoplayInterval,fe=me&&I.value&&I.value.length>=k,ve=I.value?Math.max(Math.ceil((I.value.length-k)/D)+1,0):0,de=ve&&I.autoplayInterval&&Z.current,ye=I.onPageChange&&!de,he=ye?I.page:z,be=A(i({listener:function(){xe()},when:I.responsiveOptions}),1)[0],ge=function(e,t){var n=X;null!=t?(n=D*t*-1,fe&&(n-=k),oe.current=!1):(n+=D*e,oe.current&&(n+=Q.current-D*e,oe.current=!1),t=Math.abs(Math.floor((fe?n+k:n)/D)));fe&&z===ve-1&&-1===e?(n=-1*(I.value.length+k),t=0):fe&&0===z&&1===e?(n=0,t=ve-1):t===ve-1&&Q.current>0&&(n+=-1*Q.current-D*e,oe.current=!0),G.current&&(!$()&&b.removeClass(G.current,"p-items-hidden"),Te(n),G.current.style.transition="transform 500ms ease 0s"),Ae(t),_(n)},xe=function(){if(G.current&&le.current){for(var e=window.innerWidth,t={numVisible:I.numVisible,numScroll:I.numScroll},n=0;n<le.current.length;n++){var r=le.current[n];parseInt(r.breakpoint,10)>=e&&(t=r)}if(D!==t.numScroll){var a=Math.floor(he*D/t.numScroll),o=t.numScroll*a*-1;fe&&(o-=t.numVisible),_(o),H(t.numScroll),Ae(a)}k!==t.numVisible&&B(t.numVisible)}},Se=function(e,t){(me||0!==he)&&ge(1,t),Z.current=!1,e.cancelable&&e.preventDefault()},we=function(e,t){(me||he<ve-1)&&ge(-1,t),Z.current=!1,e.cancelable&&e.preventDefault()},Ie=function(e,t){t>he?we(e,t):t<he&&Se(e,t)},Ne=function(e){G.current&&"transform"===e.propertyName&&(b.addClass(G.current,"p-items-hidden"),G.current.style.transition="",0!==z&&z!==ve-1||!fe||Te(X))},Ce=function(e){var t=e.changedTouches[0];ne.current={x:t.pageX,y:t.pageY}},Ee=function(e){e.cancelable&&e.preventDefault()},Oe=function(e){var t=e.changedTouches[0];Pe(e,pe?t.pageY-ne.current.y:t.pageX-ne.current.x)},Pe=function(e,t){Math.abs(t)>te.current&&(t<0?we(e):Se(e))},je=function(){I.autoplayInterval>0&&(re.current=setInterval((function(){ge(-1,z===ve-1?0:z+1)}),I.autoplayInterval))},ke=function(){re.current&&clearInterval(re.current)},Be=function(){ae.current||(ae.current=b.createInlineStyle(w&&w.nonce||t.nonce));var e,n="\n            .p-carousel[".concat(ee.current,"] .p-carousel-item {\n                flex: 1 0 ").concat(100/k,"%\n            }\n        ");if(I.responsiveOptions){var r=g.localeComparator(w&&w.locale||t.locale);le.current=E(e=I.responsiveOptions)||O(e)||P(e)||j(),le.current.sort((function(e,n){return g.sort(e.breakpoint,n.breakpoint,-1,r,w&&w.nullSortOrder||t.nullSortOrder)}));for(var a=0;a<le.current.length;a++){var o=le.current[a];n+="\n                    @media screen and (max-width: ".concat(o.breakpoint,") {\n                        .p-carousel[").concat(ee.current,"] .p-carousel-item {\n                            flex: 1 0 ").concat(100/o.numVisible,"%\n                        }\n                    }\n                ")}}ae.current.innerHTML=n},Te=function(e){G.current&&(G.current.style.transform=pe?"translate3d(0, ".concat(e*(100/k),"%, 0)"):"translate3d(".concat(e*(100/k),"%, 0, 0)"))},Ae=function(e){!ye&&J(e),I.onPageChange&&I.onPageChange({page:e})};e.useImperativeHandle(S,(function(){return{props:I,startAutoplay:je,stopAutoplay:ke,getElement:function(){return q.current}}})),c((function(){q.current&&(ee.current=h(),q.current.setAttribute(ee.current,"")),ae.current||(xe(),Te(X),be())})),u((function(){var e=!1,t=X;if(Be(),I.autoplayInterval&&ke(),ie!==D||ce!==k||I.value&&ue&&ue.length!==I.value.length){Q.current=(I.value.length-k)%D;var n=he;0!==ve&&n>=ve&&(Ae(n=ve-1),e=!0),t=n*D*-1,fe&&(t-=k),n===ve-1&&Q.current>0?(t+=-1*Q.current+D,oe.current=!0):oe.current=!1,t!==X&&(_(t),e=!0),Te(t)}return fe&&(0===z?t=-1*k:0===t&&(t=-1*I.value.length,Q.current>0&&(oe.current=!0)),t!==X&&(_(t),e=!0)),se!==I.page&&(I.page>se&&I.page<=ve-1?ge(-1,I.page):I.page<se&&ge(1,I.page)),!e&&de&&je(),function(){I.autoplayInterval&&ke(),ae.current=b.removeInlineStyle(ae.current)}}));var Ve,De,Re,Me,He,Le,Xe,_e=function(){if(I.value&&I.value.length){var t=null,n=null;if(fe){var r=null;t=(r=I.value.slice(-1*k)).map((function(t,n){return e.createElement(M,{key:n+"_scloned",className:"p-carousel-item-cloned",template:I.itemTemplate,item:t,active:-1*X===I.value.length+k,start:0===n,end:n===r.length-1,ptm:F,cx:K})})),n=(r=I.value.slice(0,k)).map((function(t,n){return e.createElement(M,{key:n+"_fcloned",className:"p-carousel-item-cloned",template:I.itemTemplate,item:t,active:0===X,start:0===n,end:n===r.length-1,ptm:F,cx:K})}))}var a=I.value.map((function(t,n){var r=fe?-1*(X+k):-1*X,a=r+k-1;return e.createElement(M,{key:n,template:I.itemTemplate,item:t,active:r<=n&&a>=n,start:r===n,end:a===n,ptm:F,cx:K})}));return e.createElement(e.Fragment,null,t,a,n)}},Ye=function(){if(I.showNavigators){var t=(!me||I.value&&I.value.length<k)&&0===he,n=y({className:K("previousButtonIcon")},F("previousButtonIcon")),a=x.getJSXIcon(pe?I.prevIcon||e.createElement(f,n):I.prevIcon||e.createElement(p,n),R({},n),{props:I}),o=y({type:"button",className:K("previousButton",{isDisabled:t}),onClick:function(e){return Se(e)},disabled:t,"aria-label":r("previousPageLabel")},F("previousButton"));return e.createElement("button",o,a,e.createElement(v,null))}return null},ze=function(){if(I.showNavigators){var t=(!me||I.value&&I.value.length<k)&&(he===ve-1||0===ve),n=y({className:K("nextButtonIcon")},F("nextButtonIcon")),a=x.getJSXIcon(pe?I.nextIcon||e.createElement(s,n):I.nextIcon||e.createElement(m,n),R({},n),{props:I}),o=y({type:"button",className:K("nextButton",{isDisabled:t}),onClick:function(e){return we(e)},disabled:t,"aria-label":r("nextPageLabel")},F("nextButton"));return e.createElement("button",o,a,e.createElement(v,null))}return null},Je=function(t){var n=he===t,a=function(e){return F(e,{context:{active:n}})},o=y({key:"carousel-indicator-"+t,className:K("indicator",{isActive:n}),"data-p-highlight":n},a("indicator")),l=y({type:"button",className:K("indicatorButton"),onClick:function(e){return Ie(e,t)},"aria-label":"".concat(r("pageLabel")," ").concat(t+1)},a("indicatorButton"));return e.createElement("li",o,e.createElement("button",l,e.createElement(v,null)))},Ue=(Ve=_e(),De=pe?I.verticalViewPortHeight:"auto",Re=Ye(),Me=ze(),He=y({className:K("itemsContent"),style:W("itemsContent",{height:De}),onTouchStart:function(e){return Ce(e)},onTouchMove:function(e){return Ee(e)},onTouchEnd:function(e){return Oe(e)}},F("itemsContent")),Le=y({className:d(I.containerClassName,K("container"))},F("container")),Xe=y({className:K("itemsContainer"),onTransitionEnd:Ne},F("itemsContainer")),e.createElement("div",Le,Re,e.createElement("div",He,e.createElement("div",N({ref:G},Xe),Ve)),Me)),Fe=function(){if(I.showIndicators){for(var t=[],n=0;n<ve;n++)t.push(Je(n));var r=y({className:d(I.indicatorsContentClassName,K("indicators"))},F("indicators"));return e.createElement("ul",r,t)}return null}(),Ke=function(){if(I.header){var t=y({className:K("header")},F("header"));return e.createElement("div",t,I.header)}return null}(),We=function(){if(I.footer){var t=y({className:K("footer")},F("footer"));return e.createElement("div",t,I.footer)}return null}(),$e=y({id:I.id,ref:q,className:d(I.className,K("root",{isVertical:pe})),style:I.style},V.getOtherProps(I),F("root")),qe=y({className:d(I.contentClassName,K("content"))},F("content"));return e.createElement("div",$e,Ke,e.createElement("div",qe,Ue,Fe),We)})));M.displayName="CarouselItem",H.displayName="Carousel";export{H as Carousel};
