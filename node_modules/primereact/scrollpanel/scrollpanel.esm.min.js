import*as e from"react";import{PrimeReactContext as r}from"primereact/api";import{useMountEffect as n,useUnmountEffect as t}from"primereact/hooks";import{classNames as l,mergeProps as o,DomHandler as a}from"primereact/utils";import{ComponentBase as c,useHandleStyle as s}from"primereact/componentbase";function u(){return u=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},u.apply(this,arguments)}var i=c.extend({defaultProps:{__TYPE:"ScrollPanel",id:null,style:null,className:null,children:void 0},css:{classes:{root:function(e){return l("p-scrollpanel p-component",e.props.className)},wrapper:"p-scrollpanel-wrapper",content:"p-scrollpanel-content",barx:"p-scrollpanel-bar p-scrollpanel-bar-x",bary:"p-scrollpanel-bar p-scrollpanel-bar-y"},styles:"\n        @layer primereact {\n            .p-scrollpanel-wrapper {\n                overflow: hidden;\n                width: 100%;\n                height: 100%;\n                position: relative;\n                z-index: 1;\n                float: left;\n            }\n            \n            .p-scrollpanel-content {\n                height: calc(100% + 18px);\n                width: calc(100% + 18px);\n                padding: 0 18px 18px 0;\n                position: relative;\n                overflow: auto;\n                box-sizing: border-box;\n            }\n            \n            .p-scrollpanel-bar {\n                position: relative;\n                background: #c1c1c1;\n                border-radius: 3px;\n                z-index: 2;\n                cursor: pointer;\n                opacity: 0;\n                transition: opacity 0.25s linear;\n            }\n            \n            .p-scrollpanel-bar-y {\n                width: 9px;\n                top: 0;\n            }\n            \n            .p-scrollpanel-bar-x {\n                height: 9px;\n                bottom: 0;\n            }\n            \n            .p-scrollpanel-hidden {\n                visibility: hidden;\n            }\n            \n            .p-scrollpanel:hover .p-scrollpanel-bar,\n            .p-scrollpanel:active .p-scrollpanel-bar {\n                opacity: 1;\n            }\n            \n            .p-scrollpanel-grabbed {\n                user-select: none;\n            }\n        }\n        "}}),p=e.forwardRef((function(l,c){var p=e.useContext(r),d=i.getProps(l,p),m=i.setMetaData({props:d}),f=m.ptm,h=m.cx;s(i.css.styles,m.isUnstyled,{name:"scrollpanel"});var g=e.useRef(null),b=e.useRef(null),v=e.useRef(null),x=e.useRef(null),y=e.useRef(!1),w=e.useRef(!1),E=e.useRef(null),C=e.useRef(null),R=e.useRef(null),L=e.useRef(null),H=e.useRef(null),F=e.useRef(!1),N=function(){var e=b.current.scrollWidth,r=-1*(g.current.clientHeight-v.current.clientHeight);R.current=b.current.clientWidth/e;var n=b.current.scrollHeight,t=-1*(g.current.clientWidth-x.current.clientWidth);L.current=b.current.clientHeight/n,H.current=window.requestAnimationFrame((function(){R.current>=1?a.addClass(v.current,"p-scrollpanel-hidden"):(a.removeClass(v.current,"p-scrollpanel-hidden"),v.current.style.cssText="width:"+Math.max(100*R.current,10)+"%; left:"+b.current.scrollLeft/e*100+"%;bottom:"+r+"px;"),L.current>=1?a.addClass(x.current,"p-scrollpanel-hidden"):(a.removeClass(x.current,"p-scrollpanel-hidden"),x.current.style.cssText="height:"+Math.max(100*L.current,10)+"%; top: calc("+b.current.scrollTop/n*100+"% - "+v.current.clientHeight+"px);right:"+t+"px;")}))},P=function(e){y.current?T(e):(w.current||T(e),M(e))},T=function(e){var r=e.pageX-E.current;E.current=e.pageX,H.current=window.requestAnimationFrame((function(){b.current.scrollLeft+=r/R.current}))},M=function(e){var r=e.pageY-C.current;C.current=e.pageY,H.current=window.requestAnimationFrame((function(){b.current.scrollTop+=r/L.current}))},W=function e(r){a.removeClass(x.current,"p-scrollpanel-grabbed"),a.removeClass(v.current,"p-scrollpanel-grabbed"),a.removeClass(document.body,"p-scrollpanel-grabbed"),document.removeEventListener("mousemove",P),document.removeEventListener("mouseup",e),y.current=!1,w.current=!1},z=function(){N()};n((function(){var e,r,n;N(),window.addEventListener("resize",N),e=getComputedStyle(g.current),r=getComputedStyle(v.current),n=a.getHeight(g.current)-parseInt(r.height,10),"none"!==e["max-height"]&&0===n&&(g.current.style.height=b.current.offsetHeight+parseInt(r.height,10)>parseInt(e["max-height"],10)?e["max-height"]:b.current.offsetHeight+parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)+parseFloat(e.borderTopWidth)+parseFloat(e.borderBottomWidth)+"px"),F.current=!0})),t((function(){F.current&&window.removeEventListener("resize",N),H.current&&window.cancelAnimationFrame(H.current)})),e.useImperativeHandle(c,(function(){return{props:d,refresh:z,getElement:function(){return g.current},getContent:function(){return b.current},getXBar:function(){return v.current},getYBar:function(){return x.current}}}));var D=o({id:d.id,ref:g,style:d.style,className:h("root")},i.getOtherProps(d),f("root")),O=o({className:h("wrapper")},f("wrapper")),S=o({className:h("content"),onScroll:N,onMouseEnter:N},f("content")),Y=o({ref:v,className:h("barx"),onMouseDown:function(e){y.current=!0,E.current=e.pageX,a.addClass(v.current,"p-scrollpanel-grabbed"),a.addClass(document.body,"p-scrollpanel-grabbed"),document.addEventListener("mousemove",P),document.addEventListener("mouseup",W),e.preventDefault()}},f("barx")),A=o({ref:x,className:h("bary"),onMouseDown:function(e){w.current=!0,C.current=e.pageY,a.addClass(x.current,"p-scrollpanel-grabbed"),a.addClass(document.body,"p-scrollpanel-grabbed"),document.addEventListener("mousemove",P),document.addEventListener("mouseup",W),e.preventDefault()}},f("bary"));return e.createElement("div",D,e.createElement("div",O,e.createElement("div",u({ref:b},S),d.children)),e.createElement("div",Y),e.createElement("div",A))}));p.displayName="ScrollPanel";export{p as ScrollPanel};
